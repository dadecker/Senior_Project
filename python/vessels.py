
import mysql.connector
from math import sin, cos, sqrt, atan2, radians


db = mysql.connector.connect(host = "localhost",           # database host pc
                                          port = "10060",
					  user = "root",               # database username 
					  password = "R@y6SrPjt",  # database user password
					  db = "test") 

mylat = 28.059489
mylon = -82.412234
myRange = 40.0

def inRange(mylat, mylon, s,radius):
	R = 6373.0
	lat1 = radians(mylat)
	lon1 = radians(mylon)
	if (not s[3] and not s[4]):
		return False
	else:
		lat2 = radians(float(s[3]))
		lon2 = radians(float(s[4]))

	dlon = lon2 - lon1
	dlat = lat2 - lat1

	a = sin(dlat/2)**2 + cos(lat1) * cos(lat2) * sin(dlon / 2)**2
	c = 2 * atan2(sqrt(a), sqrt(1-a))

	distance = R * c
	if (distance <= radius):
		return True
	else:
		return False

vessels = [["338122969","0","","27.510290","-82.559080","0","511","0","99","2017-11-08T23:59:27","TER","26"],["338163125","0","","27.511000","-82.557890","0","511","240","99","2017-11-08T23:59:07","TER","7"],["367744530","0","","27.530570","-82.635600","1","511","197","99","2017-11-08T23:57:30","TER","29"],["3669172","0","","27.545300","-82.574300","0","511","0","95","2017-11-09T00:01:32","TER","99"],["367343870","0","","27.586080","-82.759900","0","85","271","0","2017-11-08T23:59:41","TER","42"],["367689620","0","","27.586170","-82.759830","0","92","336","5","2017-11-09T00:01:36","TER","37"],["366902570","0","","27.586270","-82.759850","0","98","268","0","2017-11-09T00:00:09","TER","10"],["993672025","0","","27.588540","-83.011820","0","511","0","98","2017-11-09T00:01:52","TER","61"],["993672351","0","","27.613580","-82.764800","0","511","0","98","2017-11-09T00:02:08","TER","61"],["993672092","0","","27.614170","-82.665600","0","511","0","98","2017-11-08T23:57:00","TER","61"],["993672093","0","","27.615860","-82.653720","0","511","0","98","2017-11-08T23:57:04","TER","61"],["993672030","0","","27.615880","-82.666960","0","511","0","98","2017-11-09T00:01:56","TER","61"],["993672352","0","","27.616110","-82.739550","0","511","0","98","2017-11-08T23:56:44","TER","61"],["993672139","0","","27.620370","-82.655590","0","511","0","98","2017-11-09T00:01:40","TER","61"],["212960000","9318929","","27.636440","-82.563280","0","185","0","5","2017-11-09T00:00:44","TER","44"],["305931000","9240548","","27.638050","-82.563100","0","186","227","5","2017-11-09T00:01:33","TER","33"],["338123213","0","","27.662540","-82.645550","108","511","143","0","2017-11-09T00:01:06","TER","6"],["338123212","0","","27.663480","-82.646740","67","511","144","0","2017-11-09T00:00:51","TER","51"],["367333550","0","","27.684940","-82.720340","0","263","0","99","2017-11-08T23:59:20","TER","16"],["338226329","0","","27.688480","-82.722660","0","511","0","99","2017-11-09T00:01:03","TER","2"],["338209596","0","","27.712140","-82.678860","0","511","266","99","2017-11-09T00:00:46","TER","46"],["338119178","0","","27.718310","-82.478940","0","511","24","99","2017-11-09T00:02:08","TER","7"],["338168239","0","","27.723800","-82.682440","0","511","248","99","2017-11-08T23:58:06","TER","6"],["367627140","0","","27.723930","-82.682460","0","511","0","99","2017-11-09T00:01:18","TER","17"],["338154757","0","","27.724270","-82.683040","0","511","235","99","2017-11-08T23:59:25","TER","25"],["993672027","0","","27.727310","-82.534580","0","511","0","98","2017-11-08T23:56:52","TER","61"],["367770230","0","","27.740300","-82.696160","0","511","267","99","2017-11-08T23:59:55","TER","55"],["338225299","0","","27.746750","-82.722180","0","511","37","99","2017-11-09T00:01:31","TER","31"],["338145498","0","","27.747030","-82.722340","0","511","254","99","2017-11-08T23:59:41","TER","42"],["367646850","0","","27.748620","-82.722550","0","511","181","99","2017-11-08T23:58:20","TER","19"],["367600710","0","","27.751380","-82.746990","1","511","320","99","2017-11-09T00:00:09","TER","8"],["366929210","0","","27.756090","-82.732750","0","511","107","99","2017-11-09T00:01:08","TER","5"],["367296000","0","","27.758270","-82.631930","0","511","271","0","2017-11-09T00:01:09","TER","9"],["368732000","9177246","","27.758380","-82.630170","0","511","0","5","2017-11-09T00:00:35","TER","34"],["367414170","0","","27.760260","-82.633380","0","225","340","5","2017-11-09T00:01:57","TER","58"],["367758770","0","","27.760300","-82.635410","0","511","307","99","2017-11-08T23:54:25","TER","25"],["538070187","9356787","","27.760530","-82.635060","0","11","141","5","2017-11-08T23:56:23","TER","21"],["338103225","7308683","","27.760660","-82.635590","0","13","253","0","2017-11-09T00:01:29","TER","29"],["367669580","0","","27.760680","-82.636030","0","511","160","99","2017-11-09T00:01:03","TER","3"],["306126000","7802419","","27.761850","-82.630660","0","90","301","5","2017-11-09T00:00:53","TER","46"],["367741360","0","","27.765380","-82.756740","0","511","38","99","2017-11-09T00:01:21","TER","20"],["367777460","9826419","","27.765860","-82.522920","99","179","178","15","2017-11-09T00:01:18","TER","18"],["367648120","0","","27.772700","-82.628300","0","511","119","99","2017-11-09T00:01:30","TER","29"],["369143000","0","","27.775750","-82.627760","0","511","7","99","2017-11-09T00:01:41","TER","40"],["338139865","0","","27.776920","-82.629170","0","511","259","99","2017-11-09T00:01:02","TER","2"],["367780320","0","","27.776990","-82.629910","0","511","105","99","2017-11-08T23:56:37","TER","37"],["367714280","0","","27.777040","-82.629200","0","511","102","99","2017-11-08T23:56:02","TER","2"],["367487630","0","","27.780470","-82.769010","0","511","184","99","2017-11-09T00:01:36","TER","35"],["993672029","0","","27.784470","-82.523160","0","511","0","98","2017-11-09T00:02:00","TER","61"],["993672650","0","","27.786600","-82.450830","0","511","0","98","2017-11-08T23:57:40","TER","61"],["367715030","0","","27.788760","-82.785800","0","511","202","99","2017-11-08T23:56:22","TER","20"],["993672657","0","","27.793010","-82.587140","0","511","0","98","2017-11-08T23:58:28","TER","61"],["993672668","0","","27.794720","-82.599020","0","511","0","98","2017-11-08T23:58:52","TER","61"],["993672658","0","","27.794720","-82.599020","0","511","0","98","2017-11-09T00:00:24","TER","61"],["338234539","0","","27.798030","-82.780040","0","98","0","99","2017-11-09T00:01:09","TER","32"],["366919050","0","","27.807970","-82.408130","1","511","305","15","2017-11-09T00:00:52","TER","52"],["993672649","0","","27.816290","-82.428220","0","511","0","98","2017-11-08T23:57:44","TER","61"],["993672659","0","","27.824170","-82.573940","0","511","0","98","2017-11-09T00:00:28","TER","61"],["993672028","0","","27.830330","-82.447200","0","511","0","98","2017-11-09T00:02:08","TER","61"],["993672660","0","","27.832780","-82.574150","0","511","0","98","2017-11-09T00:00:32","TER","61"],["993672661","0","","27.838650","-82.567670","0","511","0","98","2017-11-08T23:58:57","TER","61"],["993672662","0","","27.845630","-82.566270","0","511","0","98","2017-11-09T00:00:36","TER","61"],["993672026","0","","27.846080","-82.561750","0","511","0","98","2017-11-09T00:02:04","TER","61"],["477699700","9720328","","27.857290","-82.392300","0","30","318","5","2017-11-08T23:59:04","TER","2"],["369142000","9719886","","27.860980","-82.551790","0","83","102","5","2017-11-09T00:01:09","TER","7"],["367561460","9686792","","27.861590","-82.547830","0","79","242","0","2017-11-08T23:59:00","TER","0"],["367560990","9641754","","27.861640","-82.547210","0","85","140","0","2017-11-08T23:58:39","TER","40"],["993672663","0","","27.872110","-82.549400","0","511","0","98","2017-11-08T23:59:01","TER","61"],["993672664","0","","27.882840","-82.544580","0","511","0","98","2017-11-09T00:00:01","TER","61"],["367005970","0","","27.884520","-82.440370","80","511","2","0","2017-11-09T00:01:39","TER","41"],["993672656","0","","27.897620","-82.443860","0","511","0","98","2017-11-09T00:01:01","TER","61"],["993672655","0","","27.899080","-82.441530","0","511","0","98","2017-11-08T23:57:52","TER","61"],["367352690","9132260","","27.903970","-82.408470","0","511","245","0","2017-11-08T23:58:39","TER","39"],["366967770","5898610","","27.906000","-82.427970","0","511","339","0","2017-11-09T00:01:34","TER","34"],["366967740","0","","27.906040","-82.427860","0","511","177","0","2017-11-09T00:01:57","TER","6"],["993672160","0","","27.907970","-82.438220","0","511","0","98","2017-11-09T00:00:13","TER","61"]]


cursor = db.cursor()
cursor.execute("USE test")
cursor.execute("DELETE FROM vessels;")

x = 1

for s in vessels:
	if (inRange(mylat, mylon, s, myRange)):
		cursor.execute("INSERT INTO vessels(entry,ID, latitude, longitude, heading, stamptime) VALUES (%s, %s, %s, %s, %s, %s);",(x,s[1], s[3], s[4], s[6], s[9]))
		x += 1

db.commit()
db.close()




